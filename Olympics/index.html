<!DOCTYPE html>
<meta charset='UTF-8'>
<head>
<script src="//d3js.org/d3.v3.min.js"></script>
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.0/jquery-ui.js"></script>

</head>
<style>
.ui-dialog {
    position: relative; 
    padding: .2em; 
    background :lavender;
    border: 2px solid white;
}
.ui-dialog .ui-dialog-content {
    border: 0
    padding: .5em 1em;
    background: lavender;
    overflow: auto;
    zoom: 1;
}
#resizable { width: 900px; height: 700px; padding: 0.5em; }
  #resizable h3 { text-align: center; margin: 0; }
table {
    border-collapse: collapse;
    width: 100%;
}

th, td {
    padding: 8px;
    text-align: left;
    border-bottom: 1px solid #ddd;
}
th{
    background-color:#f5f5f5;
}
body {
  font: sans-serif;
  font-size: 120%
  <!-- background-color : lavender -->
}
.brush .extent {
  stroke: #fff;
  fill-opacity: .500;
  shape-rendering: crispEdges;
}
.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}
svg {
  font: sans-serif;
  font-size :120%;
  
}  

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

.axis2 {font-size :75%}

.axis2 path, .axis2 line{fill :none;}


.line {
  fill: none;
  stroke: steelblue;
  stroke-width: 1.5px;
}
.line2 {
  fill: none;
  stroke: red;
  stroke-width: 1.5px;
}
.line3 {
  fill: none;
  stroke: green;
  stroke-width: 1.5px;
}
.overlay {
  fill: none;
  pointer-events: all;
}



.points circle {
  stroke: #fff;
  stroke-width: 1.5px;
  
}

div.tooltip {   
  position: absolute;           
  text-align: center;           
  width: 100px;                  
  height: 55px;                 
  padding: 2px;             
  font: 12px sans-serif;        
  background: lightsteelblue;   
  border: 0px;      
  border-radius: 8px;           
  pointer-events: none;         
}
.brush .extent {
  stroke: #fff;
  fill-opacity: .125;
  shape-rendering: crispEdges;
}
</style>
<body>

<div id="container">
      <h1 id="headline" class="viz-head">Tracing world records in athletics and swimming since 1970</h1>
         </div>  
    


<form name="info">
<tr>

<td><FONT COLOR="#4682B4">Gender:</td><td><select name ="gender" id ="gender" onchange = "updategraph();">
<option value="Men"selected >Men</option>
<option value="Women"  >Women</option></select>

<td>Sport: </td>
<td><select name="sport
" id="sport" onchange="configureDropDownLists(this,'evento');">
<option value="Athletics" >Athletics</option>
<option value="Swimming">Swimming</option>
</select></td>
<td>Event: </FONT></td>
<td><select name="event" id="evento" onchange = "updategraph();">
<option value = "100 metres" selected>100 metres</option>
<option value ="200 metres">200 metres</option>
<option value ="400 metres">400 metres</option>
<option value ="800 metres">800 metres</option>
<option value ="1500 metres">1500 metres</option>
<option value ="5,000 metres">5,000 metres</option>
<option value ="10,000 metres">10,000 metres</option>
<option value ="110 metre hurdles">110 metre hurdles</option>
<option value ="400 metre hurdles">400 metre hurdles</option>
<option value ="3,000 metres steeplechase">3,000 metres steeplechase</option>
<option value ="4x100 metres relay">4x100 metres relay</option>
<option value ="4x400 metres relay">4x400 metres relay</option>
<option value ="High jump">High jump</option>
<option value ="Pole vault">Pole vault</option>
<option value ="Long jump">Long jump</option>
<option value ="Triple jump">Triple jump</option>
<option value ="Discus throw">Discus throw</option>
<option value ="Hammer throw">Hammer throw</option>
<option value ="Javelin throw">Javelin throw</option>
<option value ="Shot put">Shot put</option>
<option value ="Marathon">Marathon</option>
<option value ="20 km walk">20 km walk</option>
<option value ="50 km walk">50 km walk</option>
</select></td>

<tr><br><br>
<td><FONT COLOR="#ff0000">Gender:</td><td><select name ="gender" id ="gender1" onchange = "updategraph();">
<option value="Men">Men</option>
<option value="Women"  selected >Women</option></select>


<td>Sport: </td>
<td><select name="sport
" id="sport1" onchange="configureDropDownLists1(this,'event1');">
<option value="Athletics" >Athletics</option>
<option value="Swimming">Swimming</option>
</select></td>
<td>Event: </FONT></td>
<td><select name="event" id="event1" onchange = "updategraph();">
<option value = "100 metres" selected>100 metres</option>
<option value ="200 metres">200 metres</option>
<option value ="400 metres">400 metres</option>
<option value ="800 metres">800 metres</option>
<option value ="1500 metres">1500 metres</option>
<option value ="5,000 metres">5,000 metres</option>
<option value ="10,000 metres">10,000 metres</option>
<option value ="110 metre hurdles">110 metre hurdles</option>
<option value ="400 metre hurdles">400 metre hurdles</option>
<option value ="3,000 metres steeplechase">3,000 metres steeplechase</option>
<option value ="4x100 metres relay">4x100 metres relay</option>
<option value ="4x400 metres relay">4x400 metres relay</option>
<option value ="High jump">High jump</option>
<option value ="Pole vault">Pole vault</option>
<option value ="Long jump">Long jump</option>
<option value ="Triple jump">Triple jump</option>
<option value ="Discus throw">Discus throw</option>
<option value ="Hammer throw">Hammer throw</option>
<option value ="Javelin throw">Javelin throw</option>
<option value ="Shot put">Shot put</option>
<option value ="Marathon">Marathon</option>
<option value ="20 km walk">20 km walk</option>
<option value ="50 km walk">50 km walk</option>
</select></td>
</tr><br><br>

<!-- <tr>

<td><FONT COLOR="#008000">Gender:</td><td><select name ="gender" id ="gender2" onchange = "updategraph();">
<option value="Men">Men</option>
<option value="Women">Women</option></select>
<td>Sport: </td>
<td><select name="sport
" id="sport2" onchange="configureDropDownLists2(this,'event2');">
<option value="Athletics" >Athletics</option>
<option value="Swimming">Swimming</option>
</select></td>
<td>Event: </FONT></td>
<td><select name="event" id="event2" onchange = "updategraph();">
<option value = "100 metres" >100 metres</option>
<option value ="200 metres"selected = "selected">200 metres</option>
<option value ="400 metres">400 metres</option>
<option value ="800 metres">800 metres</option>
<option value ="1500 metres">1500 metres</option>
<option value ="5,000 metres">5,000 metres</option>
<option value ="10,000 metres">10,000 metres</option>
<option value ="110 metre hurdles">110 metre hurdles</option>
<option value ="400 metre hurdles">400 metre hurdles</option>
<option value ="3,000 metres steeplechase">3,000 metres steeplechase</option>
<option value ="4x100 metres relay">4x100 metres relay</option>
<option value ="4x400 metres relay">4x400 metres relay</option>
<option value ="High jump">High jump</option>
<option value ="Pole vault">Pole vault</option>
<option value ="Long jump">Long jump</option>
<option value ="Triple jump">Triple jump</option>
<option value ="Discus throw">Discus throw</option>
<option value ="Hammer throw">Hammer throw</option>
<option value ="Javelin throw">Javelin throw</option>
<option value ="Shot put">Shot put</option>
<option value ="Marathon">Marathon</option>
<option value ="20 km walk">20 km walk</option>
<option value ="50 km walk">50 km walk</option>

</select></td>/tr>

</form>
< -->




<script>
//Populating the select options for event drop down

place = {
	Athletics:['100 metres','200 metres','400 metres','800 metres','1500 metres','5,000 metres',
'10,000 metres','110 metre hurdles','400 metre hurdles','3,000 metres steeplechase',
'4x100 metres relay','4x400 metres relay','High jump','Pole vault','Long jump',
'Triple jump','Discus throw','Hammer throw','Javelin throw','Shot put','Marathon',
'20 km walk','50 km walk'],
	Swimming:['Freestyle 50 metres','Freestyle 100 metres','Freestyle 200 metres','Freestyle 400 metres','Freestyle 800 metres',
'Freestyle 1500 metres','Butterfly 100 metres','Butterfly 200 metres','Breaststroke 100 metres','Breaststroke 200 metres',
'Backstroke 100 metres','Backstroke 200 metres','200 metres individual medley','400 metres individual medley',
'4x100 metres freestyle relay','4x200 metres freestyle relay','4x100 medley relay']
	}

function clearOpts(target){
	sel = document.info[target].options;
	for (i = sel.length - 1; i >= 0; i--)
		sel.remove(i);
}

function configureDropDownLists(o,event) {
	if(document.info[event].options.length!=0) clearOpts(event);
	selected = o.selectedIndex;
	if(selected== -1) return;
	event = o.options[selected].value;
	for (i = 0; i < place[event].length; i++) {
				createOption('evento', place[event][i], place[event][i]) 
			}
	updategraph();		
}

function configureDropDownLists1(o,event) {
	if(document.info[event].options.length!=0) clearOpts(event);
	selected = o.selectedIndex;
	if(selected== -1) return;
	event = o.options[selected].value;
	for (i = 0; i < place[event].length; i++) {
				createOption('event1', place[event][i], place[event][i]) 
			}
	updategraph();		
}

function configureDropDownLists2(o,event) {
	if(document.info[event].options.length!=0) clearOpts(event);
	selected = o.selectedIndex;
	if(selected== -1) return;
	event = o.options[selected].value;
	for (i = 0; i < place[event].length; i++) {
				createOption('event2', place[event][i], place[event][i]) 
			}
	updategraph();		
}

function createOption(target, label, value) {
	opts = document.info[target];
	opts.options.add(new Option(label,value) );
}
			

var margin = {top: 10, right: 10, bottom: 100, left: 60},
    margin2 = {top: 330, right: 10, bottom: 20, left: 60},
    width = 1300 - margin.left - margin.right,
    height = 400 - margin.top - margin.bottom,
    height2 = 400 - margin2.top - margin2.bottom;

	
var parseDate = d3.time.format("%Y").parse,
    bisectDate = d3.bisector(function(d) { return d.Year; }).left,
    formatValue = d3.format(",.2f"),
    formatCurrency = function(d) { return "$" + formatValue(d); };
	
var formatTime = d3.time.format("%Y");

var x = d3.time.scale()
    .range([0, width]);
var x2 = d3.time.scale().range([0,width]);
     

var y = d3.scale.linear()
    .range([height, 0]);
//var y2 = d3.scale.linear().range([height2,0]);
var xAxis = d3.svg.axis()
    .scale(x)
    .orient("bottom");

var yAxis = d3.svg.axis()
    .scale(y)
    .orient("left");
	
var xAxis2 = d3.svg.axis().scale(x2).orient("bottom");

var brush = d3.svg.brush().x(x2).on("brush", brushed);

var data, data1,data2;
var line = d3.svg.line()
    .x(function(d) { return x(d.Year); })
    .y(function(d) { return y(d.Time); });
	
var line2 = d3.svg.line()
    .x(function(d) { return x(d.Year); })
    .y(function(d) { return y(d.Time); });

var line3 = d3.svg.line()
    .x(function(d) { return x(d.Year); })
    .y(function(d) { return y(d.Time); });



var svg = d3.select("body").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
//	.style("background-color", "lavender")
  	;
	
var clipPath = svg.append("defs").append("svg:clipPath")
    .attr("id", "clip")
  .append("rect")
    .attr("width", width)
    .attr("height", height+30)
	.attr("x",0)
	.attr("y",-10);
	
var focus = svg.append("g")
    .attr("class", "focus")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

	
var context = svg.append("g")
    .attr("class", "context")
    .attr("transform", "translate(" + margin2.left + "," + margin2.top + ")");

	d3.select("body").append("br");
	
var note = 	d3.select("body").append("text")
         .style("font-weight","bold")
       // .style("text-decoration", "underline")  
        .style("font-size", "90%") 		
	    .text("Note: ")

note.append("text")
.style("font-weight","normal")
        .style("text-decoration", "none") 
           .text("Timings/Distance have been rebased to 100 to enable comparison. So, the world record time/distance in a discipline on the starting date of the visualisation (January 1, 1976) was taken as 100.And then, the progressive drop in time/distance was calculated relative to 100.")

note.append("br");
note.append("text")
        
        .attr("text-anchor", "left")  
        .style("font-size", "100%") 
		
		.style("font-weight","bold")
        .style("text-decoration", "underline") 
         .text("Data Source: Wikipedia")
	
note.append("br");
//For table
var Sumtable =d3.select("body").append("table").attr("id","table1");
var thead = Sumtable.append("thead").append("tr");
var tbody = Sumtable.append("tbody");
    



// For Tooltip
var div = d3.select("body").append("div")   

    .attr("class", "tooltip")               
    .style("opacity", 0);	

	

   
   
d3.tsv("data2.tsv", function(error, data) {
  if (error) throw error;

  data.forEach(function(d) {
    d.Year = parseDate(d.Year);
    d.Time= +d.Time;
  }); 
  var start  = parseDate('1968');
  var end = parseDate('2016');
  
  x.domain([start, end]);
 x2.domain(x.domain());
  
  data1 = data.filter(function(d){return d.Sport == "Athletics" && d.Gender =="Men" && d.Event == "100 metres"});

  var d1array =[];
  d1array[0] =[];
  d1array[0][0] = data1[0].Sport;
      d1array[0][1] = data1[0].Gender;
      d1array[0][2] = data1[0].Event;
      d1array[0][3] = data1[0].Time;
      d1array[0][4] = data1[0].Athlete;
      d1array[0][5] = data1[0].Nationality;
      //d1array[0][6] = data1[0].Location;
      d1array[0][6] = formatTime(data1[0].Year);
	  
  for (i=1;i<data1.length;i++)
   { d1array[i] = []; 
   d1array[i][0] = data1[i].Sport;
      d1array[i][1] = data1[i].Gender;
      d1array[i][2] = data1[i].Event;
      d1array[i][3] = data1[i].Time;
      d1array[i][4] = data1[i].Athlete;
      d1array[i][5] = data1[i].Nationality;
   //   d1array[i][6] = data1[i].Location;
      d1array[i][6] = formatTime(data1[i].Year);}
  
  
  data2 = data.filter(function(d){return d.Sport == "Athletics" && d.Gender =="Women" && d.Event == "100 metres"});
   
   var d2array =[];
  d2array[0] =[];
  // d2array[0][0] = data2[0].Sport;
    //  d2array[0][1] = data2[0].Gender;
     // d2array[0][2] = data2[0].Event;
   //   d2array[0][3] = data2[0].Time;
    //  d2array[0][4] = data2[0].Athlete;
    //  d2array[0][5] = data2[0].Nationality;
    //  d2array[0][6] = data2[0].Location;
     // d2array[0][7] = formatTime(data2[0].Year); 
	  
  for (i=0;i<data2.length;i++)
   { d2array[i] = []; 
   d2array[i][0] = data2[i].Sport;
      d2array[i][1] = data2[i].Gender;
      d2array[i][2] = data2[i].Event;
      d2array[i][3] = data2[i].Time;
      d2array[i][4] = data2[i].Athlete;
      d2array[i][5] = data2[i].Nationality;
    //  d2array[i][6] = data2[i].Location;
      d2array[i][6] = formatTime(data2[i].Year);}
 
 // data3 = data.filter(function(d){return d.Sport == "Athletics" && d.Gender =="Men" && d.Event == "200 metres"});
  
  superdata = data1.concat(data2);
  
  superdata.sort(function(a, b) {
    return a.Time- b.Time;
  });
   y.domain([superdata[0].Time,superdata[superdata.length -1].Time]);
   
   
   drawline1(data1);
   drawline2(data2);
  // drawline3(data3);
  
  
  
  
   rowa1data = (data1[0].Gender).concat("'s ",data1[0].Sport," ",data1[0].Event);
  rowa2data = data1.length;
  rowa3data = data1[data1.length-1].Timeinseconds - data1[0].Timeinseconds;
  
  rowa3data = rowa3data.toFixed(3);
  
  
     rowb1data = (data2[0].Gender).concat("'s ",data2[0].Sport," ",data2[0].Event);
  rowb2data = data2.length;
  rowb3data = data2[data2.length-1].Timeinseconds - data2[0].Timeinseconds;
  
  rowb3data = rowb3data.toFixed(3);
   

//     rowc1data = data3[0].Sport;
 // rowc2data = data3.length;
 // rowc3data = data3[data3.length-1].Timeinseconds - data3[0].Timeinseconds;
 
  alldata = [[rowa1data,rowa2data,rowa3data],[rowb1data,rowb2data,rowb3data]];//,[rowc1data,rowc2data,rowc3data]];
  
 //add table
 
	
var columns = ['Discipline','No of Records Set', 'Decline in Time (in seconds)'];


thead.selectAll("th")
    .data(columns)
    .enter()
    .append("th")
    .text(function(d) {
        return d;
    });
	
var trows = tbody
    .selectAll("tr")
    .data(alldata)
    .enter()
    .append("tr");

var tcells = trows
    .selectAll("td")
    .data(function(d, i) { return d; })
    .enter()
    .append("td")
    .text(function(d, i) { return d; });

thead.append("th").text('Action');
trows.selectAll("td.button")
//use a class so you don't re-select the existing <td> elements
          .data(function(d) {return [d];})
          .enter()
            .append("td")
            .attr("class", "button")
            .append("button")			
	        .attr("id",function(d,i,j) {return "button"+j;})
            .text(function(d){return "Details"});

//# creating table -on click button display

//PopTable1
var columns2 = ['Sport','Gender','Event','Time','Athlete','Nationality','Year'];

var thead2 = d3.select("#test1").selectAll("th")
    .data(columns2)
    .enter()
    .append("th")
    .text(function(d) {
        return d;
    });
	
var rows2 =d3.select("#test1").append('tbody').selectAll("tr").data(d1array).enter() .append("tr");
var cells2 = rows2.selectAll("td").data(function(d, i) { return d; })
             .enter()
             .append("td")
              .text(function(d, i) { return d; });
 
//PopTable2
var thead3 = d3.select("#test2").selectAll("th")
    .data(columns2)
    .enter()
    .append("th")
    .text(function(d) {
        return d;
    });
	
var rows3 =d3.select("#test2").append('tbody').selectAll("tr").data(d2array).enter() .append("tr");
var cells2 = rows3.selectAll("td").data(function(d, i) { return d; })
             .enter()
             .append("td")
              .text(function(d, i) { return d; });
	
////////////////////////////////
$(document).ready(function() {			
$("#button0").click(function (){
   
   $( "#dialog-modal" ).dialog({
          open : function (event, ui){$("#test1").appendTo("#dialog-modal");       
	                                   $( "#dialog-modal" ).show();
	                                   $("#test1").show();
									   },
		  //close : function (event, ui){$( "#dialog-modal" ).html(" " );},
		  height: 500,
		  width: 900,
		   modal: true
        });
$( "#resizable" ).resizable();
   
    });
	
	});
 

  /// for button1
  
  $(document).ready(function() {			
$("#button1").click(function (){

   $( "#dialog-modal1" ).dialog({
          open : function (event, ui){$("#test2").appendTo("#dialog-modal1");       
	                                  $( "#dialog-modal1" ).show();
	                                  $("#test2").show();
									 },
		 // close : function (event, ui){$( "#dialog-modal" ).html(" " );},
          height: 500,
		  width: 900,
		   modal: true
        });
$( "#resizable" ).resizable();
   //.delay(1000).fadeOut();
    });
	
	});
 
			
   ///////////////////WINDOW RESIZE///////////////////////////////////
   
   $(window).resize(function () {
   $('.ui-dialog').css({
        'width': $(window).width(),
        'height': $(window).height(),
        'left': '0px',
        'top':'0px'
   });
}).resize(); 
   })


  function  drawline1(data){
  
  

  //data.sort(function(a, b) {
   // return a.Year - b.Year;
  //});

  
  


  focus.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis);

  focus.append("g")
      .attr("class", "y axis")
      .call(yAxis)
    .append("text")
      .attr("transform", "rotate(-90)")
      .attr("y", 6)
      .attr("dy", ".71em")
      .style("text-anchor", "end")
      .text("Normalized time");

  
  focus.append("path")
      .datum(data)
      .attr("class", "line")
      .attr("d", line);
	  
 
	  

   
// Add the scatterplot
    focus.append("g").selectAll("circle")
        .data(data)
      .enter().append("circle")
        .attr("r", 3)
  .attr("fill","steelblue")
        .attr("cx", function(d) { return x(d.Year); })
        .attr("cy", function(d) { return y(d.Time); })
		 .on("mouseover", function(d) {      
            div.transition()        
                .duration(50)      
                .style("opacity", .9);
             div.html(d.Athlete+"<br/>"+"Time:" +d.Timetxt+ "(s)"+ "<br/>" +"Year:"+formatTime(d.Year) )  
                .style("left", (d3.event.pageX) + "px")     
                .style("top", (d3.event.pageY - 28) + "px");    
            })                  
        .on("mouseout", function(d) {       
            div.transition()        
                .duration(100)      
                .style("opacity", 0);   
        });
  
  //Add the time slider
  
  x2.domain(x.domain());
 // focus.append("g")
   //   .attr("class", "x axis")
     // .attr("transform", "translate(0," + 330 + ")")
      //.call(xAxis2);
var start  = parseDate('1968');
  var end = parseDate('2016');
  
  brush.extent([start,end]);
  
  context.append('rect')
	       .attr("y",2)
		   .attr("width",width)
		   .attr("height",height2/3)
		   .style("opacity",.125);
  	   
   context.append("g").attr("class", "x brush")  .call(brush)
          .selectAll("rect")
      .attr("y", 2)
      .attr("height", height2/3)
	  .attr("fill","#00008B");
	  
 context.append("g")
      .attr("class", "x axis2")
      .attr("transform", "translate(0," + (height2 -20 )+ ")")
      .call(xAxis2);
	
    
    
	



 };
function  drawline2(data){
  

  //data.sort(function(a, b) {
  //  return a.Year - b.Year;
  //});

 
  
  focus.append("path")
      .datum(data)
      .attr("class", "line2")
      .attr("d", line2);
	  

   
// Add the scatterplot
    focus.append("g").selectAll("circle")
        .data(data)
      .enter().append("circle")
        .attr("r", 3)
  .attr("fill","red")
        .attr("cx", function(d) { return x(d.Year); })
        .attr("cy", function(d) { return y(d.Time); })
		 .on("mouseover", function(d) {      
            div.transition()        
                .duration(50)      
                .style("opacity", .9);      
             div .html(d.Athlete+"<br/>"+"Time:"+ d.Timetxt+ "(s)"+ "<br/>" +"Year:"+formatTime(d.Year) )  
                .style("left", (d3.event.pageX) + "px")     
                .style("top", (d3.event.pageY - 28) + "px");    
            })                  
        .on("mouseout", function(d) {       
            div.transition()        
                .duration(100)      
                .style("opacity", 0);   
        });
   
  };
function  drawline3(data){
  

  data.sort(function(a, b) {
    return a.Year - b.Year;
  });



  
  svg.append("path")
      .datum(data)
      .attr("class", "line3")
      .attr("d", line3);
	  

   
// Add the scatterplot
    svg.append("g").selectAll("circle")
        .data(data)
      .enter().append("circle")
        .attr("r", 3)
  .attr("fill","steelblue")
        .attr("cx", function(d) { return x(d.Year); })
        .attr("cy", function(d) { return y(d.Time); })
		 .on("mouseover", function(d) {      
            div.transition()        
                .duration(50)      
                .style("opacity", .9);      
             div .html(d.Athlete+"<br/>"+"Time:"+ d.Timetxt+ "(s)"+ "<br/>" +"Year:"+formatTime(d.Year) )  
                .style("left", (d3.event.pageX) + "px")     
                .style("top", (d3.event.pageY - 28) + "px");    
            })                  
        .on("mouseout", function(d) {       
            div.transition()        
                .duration(100)      
                .style("opacity", 0);   
        });
   
  };
  
  
  
  function updategraph() {
  
  
   
   var  e = document.getElementById("gender");
  var genderselected = e.options[e.selectedIndex].value;
  var  e1 = document.getElementById("gender1");
  var genderselected1 = e1.options[e1.selectedIndex].value;
  //var  e2 = document.getElementById("gender2");
  //var genderselected2 = e2.options[e2.selectedIndex].value;
  
  var f = document.getElementById("sport");
  sportselected = f.options[f.selectedIndex].value;
  var f1 = document.getElementById("sport1");
  sportselected1 = f1.options[f1.selectedIndex].value;
//  var f2 = document.getElementById("sport2");
 // sportselected2 = f2.options[f2.selectedIndex].value;
  
  var g = document.getElementById("evento");
  eventselected = g.options[g.selectedIndex].value;
  var g1 = document.getElementById("event1");
  eventselected1 = g1.options[g1.selectedIndex].value;
 // var g2 = document.getElementById("event2");
 // eventselected2 = g2.options[g2.selectedIndex].value;
  
  d3.tsv("data2.tsv", function(error, data) {
  if (error) throw error;
  
  data.forEach(function(d) {
    d.Year = parseDate(d.Year);
    d.Time= +d.Time;
  });
  
 var start  = parseDate('1968');
  var end = parseDate('2016');
  
 
  x.domain(brush.empty() ? x2.domain() : brush.extent());

    
  data1 = data.filter(function(d){return d.Sport == sportselected && d.Gender == genderselected&& d.Event == eventselected});
 
   var d1array =[];
  d1array[0] =[];
  d1array[0][0] = data1[0].Sport;
      d1array[0][1] = data1[0].Gender;
      d1array[0][2] = data1[0].Event;
      d1array[0][3] = data1[0].Time;
      d1array[0][4] = data1[0].Athlete;
      d1array[0][5] = data1[0].Nationality;
      //d1array[0][6] = data1[0].Location;
      d1array[0][6] = formatTime(data1[0].Year);
	  
  for (i=1;i<data1.length;i++)
   { d1array[i] = []; 
   d1array[i][0] = data1[i].Sport;
      d1array[i][1] = data1[i].Gender;
      d1array[i][2] = data1[i].Event;
      d1array[i][3] = data1[i].Time;
      d1array[i][4] = data1[i].Athlete;
      d1array[i][5] = data1[i].Nationality;
    //  d1array[i][6] = data1[i].Location;
      d1array[i][6] = formatTime(data1[i].Year);}
  
  
 
  data2 = data.filter(function(d){return d.Sport == sportselected1 && d.Gender == genderselected1 && d.Event == eventselected1 });
   var d2array =[];
  d2array[0] =[];
  // d2array[0][0] = data2[0].Sport;
    //  d2array[0][1] = data2[0].Gender;
     // d2array[0][2] = data2[0].Event;
   //   d2array[0][3] = data2[0].Time;
    //  d2array[0][4] = data2[0].Athlete;
    //  d2array[0][5] = data2[0].Nationality;
    //  d2array[0][6] = data2[0].Location;
     // d2array[0][7] = formatTime(data2[0].Year); 
	  
  for (i=0;i<data2.length;i++)
   { d2array[i] = []; 
   d2array[i][0] = data2[i].Sport;
      d2array[i][1] = data2[i].Gender;
      d2array[i][2] = data2[i].Event;
      d2array[i][3] = data2[i].Time;
      d2array[i][4] = data2[i].Athlete;
      d2array[i][5] = data2[i].Nationality;
     // d2array[i][6] = data2[i].Location;
      d2array[i][6] = formatTime(data2[i].Year);}
 
  //data3 = data.filter(function(d){return d.Sport == sportselected2 && d.Gender == genderselected2&& d.Event == eventselected2});
  
  
  superdata = data1.concat(data2);
  
  superdata.sort(function(a, b) {
    return a.Time- b.Time;
  });
   y.domain([superdata[0].Time,superdata[superdata.length -1].Time]);
   
   
   redrawline1(data1);
   redrawline2(data2);
   //redrawline3(data3);
   
   
    rowa1data = (data1[0].Gender).concat("'s ",data1[0].Sport," ",data1[0].Event);
  rowa2data = data1.length;
 rowa3data = data1[data1.length-1].Timeinseconds - data1[0].Timeinseconds;
 rowa3data = rowa3data.toFixed(3);
  
  
     rowb1data = (data2[0].Gender).concat("'s ",data2[0].Sport," ",data2[0].Event);
  rowb2data = data2.length;
  rowb3data = data2[data2.length-1].Timeinseconds - data2[0].Timeinseconds;
   rowb3data = rowb3data.toFixed(3);

 //    rowc1data = data3[0].Sport;
 // rowc2data = data3.length;
  //rowc3data = data3[data3.length-1].Timeinseconds - data3[0].Timeinseconds;
  alldata = [[rowa1data,rowa2data,rowa3data],[rowb1data,rowb2data,rowb3data]];//,[rowc1data,rowc2data,rowc3data]];
  
  //add table
 

Sumtable.selectAll("tr").remove();


var columns = ['Discipline','No of Records Set', 'Decline in Time (in seconds)', 'Action'];

Sumtable.selectAll("th")
    .data(columns)
    .enter()
    .append("th")
    .text(function(d) {
        return d;
    });
	
var trows = Sumtable.selectAll("tr")
    .data(alldata)
    .enter()
    .append("tr");

var tcells = trows
    .selectAll("td")
    .data(function(d, i) { return d; })
    .enter()
    .append("td")
    .text(function(d, i) { return d; });

//thead.append("th").text('Action');
trows.selectAll("td.button")  
//use a class so you don't re-select the existing <td> elements
          .data(function(d) {return [d];})
          .enter()
            .append("td")
            .attr("class", "button")
            .append("button")			
	        .attr("id",function(d,i,j) {return "button"+j;})
            .text(function(d){return "Details"});
			
 //# creating table -on click button display
d3.select("#test3").selectAll("tr").remove();
//PopTable1
var columns2 = ['Sport','Gender','Event','Time','Athlete','Nationality','Year'];

var thead4 = d3.select("#test3").selectAll("th")
    .data(columns2)
    .enter()
    .append("th")
    .text(function(d) {
        return d;
    });
	
var rows4 =d3.select("#test3").append('tbody').selectAll("tr").data(d1array).enter() .append("tr");
var cells4 = rows4.selectAll("td").data(function(d, i) { return d; })
             .enter()
             .append("td")
              .text(function(d, i) { return d; });
 
//PopTable2
d3.select("#test4").selectAll("tr").remove();
var thead5 = d3.select("#test4").selectAll("th")
    .data(columns2)
    .enter()
    .append("th")
    .text(function(d) {
        return d;
    });
	
var rows5 =d3.select("#test4").append('tbody').selectAll("tr").data(d2array).enter() .append("tr");
var cells5= rows5.selectAll("td").data(function(d, i) { return d; })
             .enter()
             .append("td")
              .text(function(d, i) { return d; });
	
////////////////////////////////
$(document).ready(function() {			
$("#button0").click(function (){
   
   $( "#dialog-modal3" ).dialog({
          open : function (event, ui){$("#test3").appendTo("#dialog-modal3");       
	                                   $( "#dialog-modal3" ).show();
	                                   $("#test3").show();
									   },
		  //close : function (event, ui){$( "#dialog-modal" ).html(" " );},
		  height: 500,
		  width: 900,
		   modal: true
        });
$( "#resizable" ).resizable();
   
    });
	
	});
 

  /// for button1
  
  $(document).ready(function() {			
$("#button1").click(function (){

   $( "#dialog-modal4" ).dialog({
          open : function (event, ui){$("#test4").appendTo("#dialog-modal4");       
	                                  $( "#dialog-modal4" ).show();
	                                  $("#test4").show();
									 },
		 // close : function (event, ui){$( "#dialog-modal" ).html(" " );},
          height: 500,
		  width: 900,
		   modal: true
        });
$( "#resizable" ).resizable();
   //.delay(1000).fadeOut();
    });
	
	});
 
			
   ///////////////////WINDOW RESIZE///////////////////////////////////
   
   $(window).resize(function () {
   $('.ui-dialog').css({
        'width': $(window).width(),
        'height': $(window).height(),
        'left': '0px',
        'top':'0px'
   });
}).resize(); 

  
   
   })
  }
  
  function redrawline1 (data1){
  
  
  

  //data1.sort(function(a, b) {
   // return a.Year - b.Year;
  //});

  
 
    
   


    // Make the changes
	focus.selectAll(".line").remove();
	
	focus.append("path")
      .datum(data1)
      .attr("class", "line") .attr("clip-path", "url(#clip)")
      .attr("d", line)
      .transition().duration(750);
	  
     //   focus.select(".line").data(data1)		// change the line
       //     .attr("d", line)
		//	.transition().duration(750);
			
        focus.select(".x.axis") // change the x axis
            //.duration(750)
            .call(xAxis);
			
        focus.select(".y.axis") // change the y axis
           // .duration(750)
            .call(yAxis); 
		
focus.selectAll("circle").remove();
			
		// Add the scatterplot
    focus.append("g").selectAll("circle")
        .data(data1)
      .enter().append("circle")
        .attr("r", 3)
  .attr("fill","steelblue").attr("clip-path", "url(#clip)")
        .attr("cx", function(d) { return x(d.Year); })
        .attr("cy", function(d) { return y(d.Time); })
		.on("mouseover", function(d) {      
            div.transition()        
                .duration(50)      
                .style("opacity", .9);      
             div .html(d.Athlete+"<br/>"+"Time:" +d.Timetxt+ "(s)"+ "<br/>" +"Year:"+formatTime(d.Year) )  
                .style("left", (d3.event.pageX) + "px")     
                .style("top", (d3.event.pageY - 28) + "px");    
            })                  
        .on("mouseout", function(d) {       
            div.transition()        
                .duration(100)      
                .style("opacity", 0);   
        });


	
};

function redrawline2 (data2){
  
  
 

  //data2.sort(function(a, b) {
   // return a.Year - b.Year;
  //});

  
   
  
    // Select the section we want to apply our changes to
   
   	focus.select(".line2").remove();

focus.append("path")
      .datum(data2)
      .attr("class", "line2").attr("clip-path", "url(#clip)")
      .attr("d", line)
	  .transition().duration(750);
    // Make the changes
       // focus.select(".line2").data(data2)   // change the line
         //   .transition().duration(750)
           // .attr("d", line2);
			
        
		
//

			
		// Add the scatterplot
    focus.append("g").selectAll("circle")
        .data(data2)
      .enter().append("circle")
        .attr("r", 3)
  .attr("fill","red").attr("clip-path", "url(#clip)")
        .attr("cx", function(d) { return x(d.Year); })
        .attr("cy", function(d) { return y(d.Time); })
		.on("mouseover", function(d) {      
            div.transition()        
                .duration(50)      
                .style("opacity", .9);      
             div .html(d.Athlete+"<br/>"+"Time:"+ d.Timetxt+ "(s)"+ "<br/>" +"Year:"+formatTime(d.Year) )  
                .style("left", (d3.event.pageX) + "px")     
                .style("top", (d3.event.pageY - 28) + "px");    
            })                  
      .on("mouseout", function(d) {       
            div.transition()        
                .duration(100)      
                .style("opacity", 0);   
        });
	
  
};
function redrawline3 (data){
  
  
  
  data.sort(function(a, b) {
    return a.Year - b.Year;
  });

  
   
  
    // Select the section we want to apply our changes to
    var svg2 = d3.select("body").transition();
   


    // Make the changes
        svg2.select(".line3")   // change the line
            .duration(750)
            .attr("d", line3(data));
			
        
		
//

			
		// Add the scatterplot
    svg.append("g").selectAll("circle")
        .data(data)
      .enter().append("circle")
        .attr("r", 3.5)
  .attr("fill","black")
        .attr("cx", function(d) { return x(d.Year); })
        .attr("cy", function(d) { return y(d.Time); })
		.on("mouseover", function(d) {      
            div.transition()        
                .duration(50)      
                .style("opacity", .9);      
             div .html(d.Athlete+"<br/>"+"Time:" +d.Timetxt+ "(s)"+ "<br/>" +"Year:"+formatTime(d.Year) )  
                .style("left", (d3.event.pageX) + "px")     
                .style("top", (d3.event.pageY - 28) + "px");    
            })                  
        .on("mouseout", function(d) {       
            div.transition()        
                .duration(100)      
                .style("opacity", 0);   
        });
	
  
};

function brushed() {
  x.domain(brush.empty() ? x2.domain() : brush.extent());
  var array = x.domain();
  
  
  
  focus.select(".line").attr("d", line).attr("clip-path", "url(#clip)");
  focus.select(".line2").attr("d", line2).	attr("clip-path", "url(#clip)");
  
 
  focus.selectAll("circle").remove();
			
		// Add the scatterplot
    focus.append("g").selectAll("circle")
        .data(data1)
      .enter().append("circle")
        .attr("r", 3)
  .attr("fill","steelblue").attr("clip-path", "url(#clip)")
        .attr("cx", function(d) { return x(d.Year); })
        .attr("cy", function(d) { return y(d.Time)	; })
		.on("mouseover", function(d) {      
            div.transition()        
                .duration(50)      
                .style("opacity", .9);      
             div .html(d.Athlete+"<br/>"+"Time:" +d.Timetxt+ "(s)"+ "<br/>" +"Year:"+formatTime(d.Year) )  
                .style("left", (d3.event.pageX) + "px")     
                .style("top", (d3.event.pageY - 28) + "px");    
            })                  
        .on("mouseout", function(d) {       
            div.transition()        
                .duration(100)      
                .style("opacity", 0);   
        });
		
				// Add the scatterplot
    focus.append("g").selectAll("circle")
        .data(data2)
      .enter().append("circle")
        .attr("r", 3)
  .attr("fill","red").attr("clip-path", "url(#clip)")
        .attr("cx", function(d) { return x(d.Year); })
        .attr("cy", function(d) { return y(d.Time); })
		.on("mouseover", function(d) {      
            div.transition()        
                .duration(50)      
                .style("opacity", .9);      
             div .html(d.Athlete+"<br/>"+"Time:" +d.Timetxt+ "(s)"+ "<br/>" +"Year:"+formatTime(d.Year) )  
                .style("left", (d3.event.pageX) + "px")     
                .style("top", (d3.event.pageY - 28) + "px");    
            })                  
        .on("mouseout", function(d) {       
            div.transition()        
                .duration(100)      
                .style("opacity", 0);   
        });
  focus.select(".x.axis").transition().call(xAxis);
  
}


svg.append("text")
        .attr("x",width-100)             
        .attr("y", height+175)
        .attr("text-anchor", "right")  
        .style("font-size", "75%") 
		.style("font-weight","bold")
        .style("text-decoration", "underline") 
        //.style("cursor","pointer")		
        .text("Data Source: Wikipedia")		
</script>

<div id="dialog-modal" style="display:none"></div>
<div id="dialog-modal1" style="display:none"></div>
<div id="dialog-modal3" style="display:none"></div>
<div id="dialog-modal4" style="display:none"></div>

<table id = "test1" style = "display:none"></table>
<table id = "test2" style = "display:none"></table>
<table id = "test3" style = "display:none"></table>
<table id = "test4" style = "display:none"></table>
<div id="Sumtable"	>
<table style="width:50%">
  <!--  <tr>
    <th>Discipline</th>
    <th>No of records sets</th> 
    <th>Decline in Time(seconds)</th>
  </tr>
  <tr> -->
   
</table>
</div>